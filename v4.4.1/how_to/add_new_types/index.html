<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>...customize or add a new Type · PowerSystems.jl</title><meta name="title" content="...customize or add a new Type · PowerSystems.jl"/><meta property="og:title" content="...customize or add a new Type · PowerSystems.jl"/><meta property="twitter:title" content="...customize or add a new Type · PowerSystems.jl"/><meta name="description" content="Documentation for PowerSystems.jl."/><meta property="og:description" content="Documentation for PowerSystems.jl."/><meta property="twitter:description" content="Documentation for PowerSystems.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PowerSystems.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PowerSystems.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome Page</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/creating_system/">Create and Explore a Power <code>System</code></a></li><li><a class="tocitem" href="../../tutorials/working_with_time_series/">Working with Time Series</a></li><li><a class="tocitem" href="../../tutorials/add_dynamic_data/">Adding Data for Dynamic Simulations</a></li></ul></li><li><span class="tocitem">How to...</span><ul><li><a class="tocitem" href="../install/">...install PowerSystems.jl</a></li><li><a class="tocitem" href="../powersystembuilder/">...load a <code>system</code> from <code>PowerSystemCaseBuilder</code></a></li><li><a class="tocitem" href="../parse_matpower_psse/">...parse data from MATPOWER or PSS/e files</a></li><li><a class="tocitem" href="../parse_dynamic_data/">...parse PSS/e dynamic data</a></li><li><a class="tocitem" href="../parse_tabular_data/">...parse tabular data from .csv files</a></li><li><a class="tocitem" href="../parse_ts_from_csvs/">...parse time series data from .csv files</a></li><li><a class="tocitem" href="../add_component_natural_units/">...add a component using natural units (MW)</a></li><li><a class="tocitem" href="../get_buses/">...get all the buses in a system</a></li><li><a class="tocitem" href="../get_available_generators/">...get the available generators in a system</a></li><li><a class="tocitem" href="../add_cost_curve/">...add an Operating Cost</a></li><li><a class="tocitem" href="../market_bid_cost/">...add a market bid</a></li><li><a class="tocitem" href="../adding_additional_fields/">...add additional data to a component</a></li><li class="is-active"><a class="tocitem" href>...customize or add a new Type</a><ul class="internal"><li><a class="tocitem" href="#Type-Hierarchy"><span>Type Hierarchy</span></a></li><li><a class="tocitem" href="#Interfaces"><span>Interfaces</span></a></li><li><a class="tocitem" href="#Specialize-an-Existing-Type"><span>Specialize an Existing Type</span></a></li><li><a class="tocitem" href="#Custom-Rules"><span>Custom Rules</span></a></li><li><a class="tocitem" href="#autogen"><span>Auto-generating Structs</span></a></li></ul></li><li><a class="tocitem" href="../improve_ts_performance/">...improve performance with time series data</a></li><li><a class="tocitem" href="../serialize_data/">...write and read data with a JSON</a></li><li><a class="tocitem" href="../reduce_repl_printing/">...reduce REPL printing</a></li><li><a class="tocitem" href="../migrating_to_psy4/">...migrate from version 3.0 to 4.0</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../../explanation/system/">System</a></li><li><a class="tocitem" href="../../explanation/type_structure/">Type Structure</a></li><li><a class="tocitem" href="../../explanation/per_unit/">Per-unit Conventions</a></li><li><a class="tocitem" href="../../explanation/time_series/">Time Series Data</a></li><li><a class="tocitem" href="../../explanation/dynamic_data/">Dynamic Devices</a></li></ul></li><li><span class="tocitem">Model Library</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">DynamicInverterComponent</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_Converter/">Converter</a></li><li><a class="tocitem" href="../../model_library/generated_DCSource/">DCSource</a></li><li><a class="tocitem" href="../../model_library/generated_Filter/">Filter</a></li><li><a class="tocitem" href="../../model_library/generated_FrequencyEstimator/">FrequencyEstimator</a></li><li><a class="tocitem" href="../../model_library/generated_InnerControl/">InnerControl</a></li><li><a class="tocitem" href="../../model_library/generated_OutputCurrentLimiter/">OutputCurrentLimiter</a></li><li><a class="tocitem" href="../../model_library/outer_control/">OuterControl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">StaticInjection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_FixedAdmittance/">FixedAdmittance</a></li><li><a class="tocitem" href="../../model_library/generated_InterruptiblePowerLoad/">InterruptiblePowerLoad</a></li><li><a class="tocitem" href="../../model_library/generated_ExponentialLoad/">ExponentialLoad</a></li><li><a class="tocitem" href="../../model_library/generated_PowerLoad/">PowerLoad</a></li><li><a class="tocitem" href="../../model_library/generated_StandardLoad/">StandardLoad</a></li><li><a class="tocitem" href="../../model_library/generated_SwitchedAdmittance/">SwitchedAdmittance</a></li><li><a class="tocitem" href="../../model_library/generated_HydroDispatch/">HydroDispatch</a></li><li><a class="tocitem" href="../../model_library/generated_HydroEnergyReservoir/">HydroEnergyReservoir</a></li><li><a class="tocitem" href="../../model_library/generated_HydroPumpedStorage/">HydroPumpedStorage</a></li><li><a class="tocitem" href="../../model_library/generated_RenewableDispatch/">RenewableDispatch</a></li><li><a class="tocitem" href="../../model_library/generated_RenewableNonDispatch/">RenewableNonDispatch</a></li><li><a class="tocitem" href="../../model_library/generated_ThermalMultiStart/">ThermalMultiStart</a></li><li><a class="tocitem" href="../../model_library/generated_ThermalStandard/">ThermalStandard</a></li><li><a class="tocitem" href="../../model_library/generated_InterconnectingConverter/">InterconnectingConverter</a></li><li><a class="tocitem" href="../../model_library/generated_Source/">Source</a></li><li><a class="tocitem" href="../../model_library/generated_EnergyReservoirStorage/">EnergyReservoirStorage</a></li><li><a class="tocitem" href="../../model_library/hybrid_system/">HybridSystem</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Operating Costs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/thermal_generation_cost/">ThermalGenerationCost</a></li><li><a class="tocitem" href="../../model_library/hydro_generation_cost/">HydroGenerationCost</a></li><li><a class="tocitem" href="../../model_library/renewable_generation_cost/">RenewableGenerationCost</a></li><li><a class="tocitem" href="../../model_library/storage_cost/">StorageCost</a></li><li><a class="tocitem" href="../../model_library/load_cost/">LoadCost</a></li><li><a class="tocitem" href="../../model_library/market_bid_cost/">MarketBidCost</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Topology</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_Area/">Area</a></li><li><a class="tocitem" href="../../model_library/generated_LoadZone/">LoadZone</a></li><li><a class="tocitem" href="../../model_library/generated_Arc/">Arc</a></li><li><a class="tocitem" href="../../model_library/generated_ACBus/">ACBus</a></li><li><a class="tocitem" href="../../model_library/generated_DCBus/">DCBus</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">DynamicInjection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_ActiveConstantPowerLoad/">ActiveConstantPowerLoad</a></li><li><a class="tocitem" href="../../model_library/generated_AggregateDistributedGenerationA/">AggregateDistributedGenerationA</a></li><li><a class="tocitem" href="../../model_library/generated_CSVGN1/">CSVGN1</a></li><li><a class="tocitem" href="../../model_library/generated_DynamicExponentialLoad/">DynamicExponentialLoad</a></li><li><a class="tocitem" href="../../model_library/generated_GenericDER/">GenericDER</a></li><li><a class="tocitem" href="../../model_library/generated_PeriodicVariableSource/">PeriodicVariableSource</a></li><li><a class="tocitem" href="../../model_library/generated_SimplifiedSingleCageInductionMachine/">SimplifiedSingleCageInductionMachine</a></li><li><a class="tocitem" href="../../model_library/generated_SingleCageInductionMachine/">SingleCageInductionMachine</a></li><li><a class="tocitem" href="../../model_library/dynamic_inverter/">Dynamic Inverter</a></li><li><a class="tocitem" href="../../model_library/dynamic_generator/">Dynamic Generator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Service</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_AGC/">AGC</a></li><li><a class="tocitem" href="../../model_library/generated_ConstantReserveNonSpinning/">ConstantReserveNonSpinning</a></li><li><a class="tocitem" href="../../model_library/generated_VariableReserveNonSpinning/">VariableReserveNonSpinning</a></li><li><a class="tocitem" href="../../model_library/generated_TransmissionInterface/">TransmissionInterface</a></li><li><a class="tocitem" href="../../model_library/reserves/">Reserves</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Branch</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_Line/">Line</a></li><li><a class="tocitem" href="../../model_library/generated_MonitoredLine/">MonitoredLine</a></li><li><a class="tocitem" href="../../model_library/generated_PhaseShiftingTransformer/">PhaseShiftingTransformer</a></li><li><a class="tocitem" href="../../model_library/generated_TapTransformer/">TapTransformer</a></li><li><a class="tocitem" href="../../model_library/generated_Transformer2W/">Transformer2W</a></li><li><a class="tocitem" href="../../model_library/generated_TwoTerminalHVDCLine/">TwoTerminalHVDCLine</a></li><li><a class="tocitem" href="../../model_library/generated_TwoTerminalVSCDCLine/">TwoTerminalVSCDCLine</a></li><li><a class="tocitem" href="../../model_library/generated_AreaInterchange/">AreaInterchange</a></li><li><a class="tocitem" href="../../model_library/generated_TModelHVDCLine/">TModelHVDCLine</a></li><li><a class="tocitem" href="../../model_library/dynamic_branch/">Dynamic Lines</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">DynamicGeneratorComponent</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_AVR/">AVR</a></li><li><a class="tocitem" href="../../model_library/generated_Machine/">Machine</a></li><li><a class="tocitem" href="../../model_library/generated_PSS/">PSS</a></li><li><a class="tocitem" href="../../model_library/generated_Shaft/">Shaft</a></li><li><a class="tocitem" href="../../model_library/generated_TurbineGov/">TurbineGov</a></li></ul></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../api/public/">Public API</a></li><li><a class="tocitem" href="../../api/glossary/">Glossary and Acronyms</a></li><li><a class="tocitem" href="../../api/type_tree/">Type Tree</a></li><li><a class="tocitem" href="../../api/valuecurve_options/"><code>ValueCurve</code> Options</a></li><li><a class="tocitem" href="../../api/enumerated_types/">Specifying the category of...</a></li><li><a class="tocitem" href="../../api/citation/">Citation</a></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Developers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/developer_guidelines/">Developer Guidelines</a></li><li><a class="tocitem" href="../../api/internal/">Internals</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to...</a></li><li class="is-active"><a href>...customize or add a new Type</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>...customize or add a new Type</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/PowerSystems.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/PowerSystems.jl/blob/main/docs/src/how_to/add_new_types.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Add-a-New-or-Custom-Type"><a class="docs-heading-anchor" href="#Add-a-New-or-Custom-Type">Add a New or Custom Type</a><a id="Add-a-New-or-Custom-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Add-a-New-or-Custom-Type" title="Permalink"></a></h1><p>This page describes how developers should add types to <code>PowerSystems.jl</code></p><h2 id="Type-Hierarchy"><a class="docs-heading-anchor" href="#Type-Hierarchy">Type Hierarchy</a><a id="Type-Hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Hierarchy" title="Permalink"></a></h2><p>All structs that correlate to power system components must be subtypes of the <a href="../../api/public/#PowerSystems.Component"><code>Component</code></a> abstract type. Browse its type hierachy to choose an appropriate supertype for your new struct.</p><h2 id="Interfaces"><a class="docs-heading-anchor" href="#Interfaces">Interfaces</a><a id="Interfaces-1"></a><a class="docs-heading-anchor-permalink" href="#Interfaces" title="Permalink"></a></h2><p>Refer to the <a href="https://nrel-sienna.github.io/InfrastructureSystems.jl/stable/dev_guide/components_and_container/">managing components guide</a> for component requirements.</p><p>In particular, please note the methods <code>supports_time_series</code> (default = false) and <code>supports_supplemental_attributes</code> (default = true) that you may need to implement.</p><p><strong>Note</strong>: <code>get_internal</code> and <code>get_name</code> are imported into <code>PowerSystems</code>, so you should implement your methods as <code>PowerSystems</code> methods.</p><p>Some abstract types define required interface functions in docstring. Be sure to implement each of them for your new type.</p><p>Formalized documentation for each abstract type is TBD.</p><h2 id="Specialize-an-Existing-Type"><a class="docs-heading-anchor" href="#Specialize-an-Existing-Type">Specialize an Existing Type</a><a id="Specialize-an-Existing-Type-1"></a><a class="docs-heading-anchor-permalink" href="#Specialize-an-Existing-Type" title="Permalink"></a></h2><p>There are scenarios where you may want to make a new type that is identical to an existing type except for one attribute or behavior, and don&#39;t want to duplicate the entire existing type and methods. In programming languages that support inheritance you would derive a new class from the existing class and automatically inherit its fields and methods. Julia doesn&#39;t support that. However, you can achieve a similar result with a forwarding macro. The basic idea is that you include the existing type within your struct and then use a macro to automatically forward specific methods to that instance.</p><p>A few PowerSystems structs use the macro <code>InfrastructureSystems.@forward</code> to do this. Refer to the struct <a href="../../model_library/generated_Machine/#RoundRotorQuadratic"><code>RoundRotorQuadratic</code></a> for an example of how to use this.</p><h2 id="Custom-Rules"><a class="docs-heading-anchor" href="#Custom-Rules">Custom Rules</a><a id="Custom-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Rules" title="Permalink"></a></h2><p>Some types require special checks before they can be added to or removed from a system. One example is the case where a component includes another component that is also stored in the system. We must ensure that the parent component does not contain a reference to another component that is not already attached to the system.</p><p>Similarly, if the child object is removed from the system we must also remove the parent&#39;s reference to that child.</p><p>The source file <code>src/base.jl</code> provides functions that you can implement for your new type to manage these scenarios.</p><ul><li><code>check_component_addition(sys::System, component::Component; kwargs...)</code></li><li><code>handle_component_addition!(sys::System, component::Component; kwargs...)</code></li><li><code>check_component_removal(sys::System, component::Component; kwargs...)</code></li><li><code>handle_component_removal!(sys::System, component::Component; kwargs...)</code></li></ul><p>The functions <code>add_component!()</code> and <code>remove_component!()</code> call the check function before performing actions and then call the handle function afterwards. The default behavior of these functions is to do nothing. Implement versions that take your type in order to add your own checks or perform additional actions.</p><p>Beware of the condition where a custom method is already implemented for a supertype of your type.</p><p>Note that you can call the helper functions <code>is_attached(component, system)</code> and <code>throw_if_not_attached(component, system)</code>.</p><h3 id="Custom-Validation"><a class="docs-heading-anchor" href="#Custom-Validation">Custom Validation</a><a id="Custom-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Validation" title="Permalink"></a></h3><p>You can implement three methods to perform custom validation or correction for your type. PowerSystems calls all of these functions in <code>add_component!</code>.</p><ul><li><code>sanitize_component!(component::Component, sys::System)</code>: intended to make standard data corrections (e.g. voltage angle in degrees -&gt; radians)</li><li><code>validate_component(component::Component)</code>: intended to check component field values for internal consistency</li><li><code>validate_component_with_system(component::Component, sys::System)</code>: intended to check component field values for consistency with system</li></ul><h3 id="Struct-Requirements-for-Serialization-of-custom-components"><a class="docs-heading-anchor" href="#Struct-Requirements-for-Serialization-of-custom-components">Struct Requirements for Serialization of custom components</a><a id="Struct-Requirements-for-Serialization-of-custom-components-1"></a><a class="docs-heading-anchor-permalink" href="#Struct-Requirements-for-Serialization-of-custom-components" title="Permalink"></a></h3><p>One key feature of <code>PowerSystems.jl</code> is the serialization capabilities. Supporting serialization and de-serialization of custom components requires the implementation of several methods. The serialization code converts structs to dictionaries where the struct fields become dictionary keys.</p><p>The code imposes these requirements:</p><ol><li>The InfrastructureSystems methods <code>serialize</code> and <code>deserialize</code> must be implemented for the struct. InfrastructureSystems implements a method that covers all subtypes of <code>InfrastructureSystemsType</code>. All PowerSystems components should be subtypes of <code>PowerSystems.Component</code> which is a subtype <code>InfrastructureSystemsType</code>, so any new structs should be covered as well.</li><li>All struct fields must be able to be encoded in JSON format or be covered be covered by <code>serialize</code> and <code>deserialize</code> methods. Basic types, such as numbers and strings or arrays and dictionaries of numbers and strings, should just work. Complex containers with symbols may not.</li><li>Structs relying on the default <code>deserialize</code> method must have a kwarg-only constructor. The deserialization code constructs objects by splatting the dictionary key/value pairs into the constructor.</li><li>Structs that contain other PowerSystem components (like a generator contains a bus) must serialize those components as UUIDs instead of actual values. The deserialization code uses the UUIDs as a mechanism to restore a reference to the actual object rather a new object with identical values. It also significantly reduces the size of the JSON file.</li></ol><p>Refer to <code>InfrastructureSystems.serialize_struct</code> for example behavior. New structs that are not subtypes of <code>InfrastructureSystemsType</code> may be able to call it directly.</p><h4 id="How-to-trouble-shoot-serialization-issues"><a class="docs-heading-anchor" href="#How-to-trouble-shoot-serialization-issues">How to trouble-shoot serialization issues</a><a id="How-to-trouble-shoot-serialization-issues-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-trouble-shoot-serialization-issues" title="Permalink"></a></h4><p>Here are some examples of potential problems and solutions if you need to implement custom <code>InfrastructureSystems.serialize</code> and <code>InfrastructureSystems.deserialize</code> methods for your type.:</p><p><strong>Problem</strong>: Your struct contains a field defined as an abstract type. The deserialization process doesn&#39;t know what concrete type to construct.</p><p><em>Solution</em>: Encode the concrete type into the serialized dictionary as a string.</p><p><em>Example</em>:  <code>serialize</code> and <code>deserialize</code> methods for <code>DynamicBranch</code> in <code>src/models/dynamic_branch.jl</code>.</p><p><strong>Problem</strong>: Similar to above in that a field is defined as an abstract type but the struct is parameterized on the actual concrete type.</p><p><em>Solution</em>: Use the fact that the concrete type is encoded into the serialized type of the struct and extract it in a customized <code>deserialze</code> method.</p><p><em>Example</em>: <code>deserialize</code> method for <code>OuterControl</code> in <code>src/models/OuterControl.jl</code>.</p><h3 id="Adding-PowerSystems.jl-as-a-dependency-in-a-modeling-package"><a class="docs-heading-anchor" href="#Adding-PowerSystems.jl-as-a-dependency-in-a-modeling-package">Adding <code>PowerSystems.jl</code> as a dependency in a modeling package</a><a id="Adding-PowerSystems.jl-as-a-dependency-in-a-modeling-package-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-PowerSystems.jl-as-a-dependency-in-a-modeling-package" title="Permalink"></a></h3><pre><code class="language-julia hljs">module MyModelingModule

import PowerSystems
import InfrastructureSystems
const PSY = PowerSystems
const IS = InfrastructureSystems

export MyDevice
export get_name

mutable struct MyDevice &lt;: PSY.Device
    name::String
    internal::IS.InfrastructureSystemsInternal
end

function MyDevice(name::String)
    return MyDevice(name, IS.InfrastructureSystemsInternal())
end

PSY.get_name(val::MyDevice) = val.name

end</code></pre><h2 id="autogen"><a class="docs-heading-anchor" href="#autogen">Auto-generating Structs</a><a id="autogen-1"></a><a class="docs-heading-anchor-permalink" href="#autogen" title="Permalink"></a></h2><p>Most <code>PowerSystems.jl</code> structs are auto-generated from the JSON descriptor file <code>src/descriptors/power_system_structs.json</code>. You can add your new struct here or write it manually when contributing code to the repository.</p><p>If all you need is the basic struct definition and getter/setter functions then you will likely find the auto-generation helpful.</p><p>If you will need to write specialized functions for the type then you will probably want to write it manually.</p><p>Please refer to the docstrings for the functions <code>generate_struct</code> and <code>generate_structs</code>. Full details are in the InfrastructureSystems documentation at <a href="https://nrel-sienna.github.io/InfrastructureSystems.jl/stable/dev_guide/auto_generation/">https://nrel-sienna.github.io/InfrastructureSystems.jl/stable/dev<em>guide/auto</em>generation/</a>.</p><h3 id="Testing-the-addition-of-new-struct-to-the-code-base"><a class="docs-heading-anchor" href="#Testing-the-addition-of-new-struct-to-the-code-base">Testing the addition of new struct to the code base</a><a id="Testing-the-addition-of-new-struct-to-the-code-base-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-the-addition-of-new-struct-to-the-code-base" title="Permalink"></a></h3><p>In order to merge new structs to the code base, your struct needs to pass several tests.</p><ol><li>addition to <code>System</code></li><li>retrieval from <code>System</code></li><li>serialization/de-serialization</li></ol><p>The following code block is an example of the code that the new struct needs to pass</p><pre><code class="language-julia hljs">using PowerSystems

sys = System(100.0)
device = NewType(data)

# add your component to the system
add_component!(sys, device)
retrived_device = get_component(NewType, sys, &quot;component_name&quot;)

# Serialize
to_json(sys, &quot;sys.json&quot;)

# Re-create the system and find your component.
sys2 = System(&quot;sys.json&quot;)
serialized_device = get_component(NewType, sys, &quot;component_name&quot;)

@test get_name(retrieved_device) == get_name(serialized_device)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../adding_additional_fields/">« ...add additional data to a component</a><a class="docs-footer-nextpage" href="../improve_ts_performance/">...improve performance with time series data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 26 December 2024 22:39">Thursday 26 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
