<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time Series Data Â· PowerSystems.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PowerSystems.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PowerSystems.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome Page</a></li><li><a class="tocitem" href="../../quick_start_guide/">Quick Start Guide</a></li><li><a class="tocitem" href="../../tutorials/intro_page/">Tutorials</a></li><li><span class="tocitem">Modeler Guide</span><ul><li><a class="tocitem" href="../type_structure/">Type Structure</a></li><li><a class="tocitem" href="../system/">System</a></li><li class="is-active"><a class="tocitem" href>Time Series Data</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Storage"><span>Storage</span></a></li><li><a class="tocitem" href="#Creating-Time-Series-Data"><span>Creating Time Series Data</span></a></li><li><a class="tocitem" href="#Scaling-factors"><span>Scaling factors</span></a></li><li><a class="tocitem" href="#Adding-time-series-to-the-System"><span>Adding time series to the System</span></a></li><li><a class="tocitem" href="#Removing-time-series-data"><span>Removing time series data</span></a></li><li><a class="tocitem" href="#Retrieving-time-series-data"><span>Retrieving time series data</span></a></li><li><a class="tocitem" href="#Data-exploration"><span>Data exploration</span></a></li><li><a class="tocitem" href="#Using-forecast-data-in-simulations"><span>Using forecast data in simulations</span></a></li><li><a class="tocitem" href="#Transform-static-time-series-into-forecasts"><span>Transform static time series into forecasts</span></a></li><li><a class="tocitem" href="#Time-Series-Validation"><span>Time Series Validation</span></a></li><li><a class="tocitem" href="#Data-Format"><span>Data Format</span></a></li></ul></li><li><a class="tocitem" href="../enumerated_types/">Enumerated Types</a></li><li><a class="tocitem" href="../example_dynamic_data/">Dynamic Devices</a></li><li><a class="tocitem" href="../system_dynamic_data/">Creating a System with Dynamic devices</a></li><li><a class="tocitem" href="../market_bid_cost/">PowerSystems <code>MarketBidCost</code></a></li><li><a class="tocitem" href="../generated_modeling_with_JuMP/">Modeling With Jump</a></li><li><a class="tocitem" href="../generated_network_matrices/">Network Matrices</a></li><li><a class="tocitem" href="../generated_parsing/">Parsing</a></li><li><a class="tocitem" href="../generated_power_flow/">Power Flow</a></li></ul></li><li><span class="tocitem">Model Developer Guide</span><ul><li><a class="tocitem" href="../../model_developer_guide/extending_parsing/">Extending Parsing</a></li><li><a class="tocitem" href="../../model_developer_guide/adding_custom_types/">Adding Types</a></li><li><a class="tocitem" href="../../model_developer_guide/generated_adding_additional_fields/">Adding Additional Fields</a></li></ul></li><li><span class="tocitem">Code Base Developer Guide</span><ul><li><a class="tocitem" href="../../code_base_developer_guide/developer/">Developer Guide</a></li><li><a class="tocitem" href="../../code_base_developer_guide/adding_new_types/">Adding New Types</a></li><li><a class="tocitem" href="../../code_base_developer_guide/troubleshooting/">Troubleshooting</a></li></ul></li><li><span class="tocitem">Model Library</span><ul><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">DeviceParameter</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_MarketBidCost/">MarketBidCost</a></li><li><a class="tocitem" href="../../model_library/generated_MultiStartCost/">MultiStartCost</a></li><li><a class="tocitem" href="../../model_library/generated_StorageManagementCost/">StorageManagementCost</a></li><li><a class="tocitem" href="../../model_library/generated_ThreePartCost/">ThreePartCost</a></li><li><a class="tocitem" href="../../model_library/generated_TwoPartCost/">TwoPartCost</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">DynamicInverterComponent</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_Converter/">Converter</a></li><li><a class="tocitem" href="../../model_library/generated_DCSource/">DCSource</a></li><li><a class="tocitem" href="../../model_library/generated_Filter/">Filter</a></li><li><a class="tocitem" href="../../model_library/generated_FrequencyEstimator/">FrequencyEstimator</a></li><li><a class="tocitem" href="../../model_library/generated_InnerControl/">InnerControl</a></li><li><a class="tocitem" href="../../model_library/outer_control/">OuterControl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-3" type="checkbox"/><label class="tocitem" for="menuitem-7-3"><span class="docs-label">StaticInjection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_InterruptibleLoad/">InterruptibleLoad</a></li><li><a class="tocitem" href="../../model_library/generated_FixedAdmittance/">FixedAdmittance</a></li><li><a class="tocitem" href="../../model_library/generated_PowerLoad/">PowerLoad</a></li><li><a class="tocitem" href="../../model_library/generated_HydroDispatch/">HydroDispatch</a></li><li><a class="tocitem" href="../../model_library/generated_HydroEnergyReservoir/">HydroEnergyReservoir</a></li><li><a class="tocitem" href="../../model_library/generated_HydroPumpedStorage/">HydroPumpedStorage</a></li><li><a class="tocitem" href="../../model_library/generated_RenewableDispatch/">RenewableDispatch</a></li><li><a class="tocitem" href="../../model_library/generated_RenewableFix/">RenewableFix</a></li><li><a class="tocitem" href="../../model_library/generated_ThermalMultiStart/">ThermalMultiStart</a></li><li><a class="tocitem" href="../../model_library/generated_ThermalStandard/">ThermalStandard</a></li><li><a class="tocitem" href="../../model_library/generated_Source/">Source</a></li><li><a class="tocitem" href="../../model_library/generated_HybridSystem/">HybridSystem</a></li><li><a class="tocitem" href="../../model_library/generated_BatteryEMS/">BatteryEMS</a></li><li><a class="tocitem" href="../../model_library/generated_GenericBattery/">GenericBattery</a></li><li><a class="tocitem" href="../../model_library/hybrid_device/">HybridSystem</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-4" type="checkbox"/><label class="tocitem" for="menuitem-7-4"><span class="docs-label">Topology</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_Area/">Area</a></li><li><a class="tocitem" href="../../model_library/generated_LoadZone/">LoadZone</a></li><li><a class="tocitem" href="../../model_library/generated_Arc/">Arc</a></li><li><a class="tocitem" href="../../model_library/generated_Bus/">Bus</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-5" type="checkbox"/><label class="tocitem" for="menuitem-7-5"><span class="docs-label">DynamicInjection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/dynamic_inverter/">Dynamic Inverter</a></li><li><a class="tocitem" href="../../model_library/dynamic_generator/">Dynamic Generator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-6" type="checkbox"/><label class="tocitem" for="menuitem-7-6"><span class="docs-label">Service</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_AGC/">AGC</a></li><li><a class="tocitem" href="../../model_library/generated_StaticReserveNonSpinning/">StaticReserveNonSpinning</a></li><li><a class="tocitem" href="../../model_library/generated_VariableReserveNonSpinning/">VariableReserveNonSpinning</a></li><li><a class="tocitem" href="../../model_library/generated_Transfer/">Transfer</a></li><li><a class="tocitem" href="../../model_library/reserves/">Reserves</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-7" type="checkbox"/><label class="tocitem" for="menuitem-7-7"><span class="docs-label">Branch</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_Line/">Line</a></li><li><a class="tocitem" href="../../model_library/generated_MonitoredLine/">MonitoredLine</a></li><li><a class="tocitem" href="../../model_library/generated_PhaseShiftingTransformer/">PhaseShiftingTransformer</a></li><li><a class="tocitem" href="../../model_library/generated_TapTransformer/">TapTransformer</a></li><li><a class="tocitem" href="../../model_library/generated_Transformer2W/">Transformer2W</a></li><li><a class="tocitem" href="../../model_library/generated_HVDCLine/">HVDCLine</a></li><li><a class="tocitem" href="../../model_library/generated_VSCDCLine/">VSCDCLine</a></li><li><a class="tocitem" href="../../model_library/dynamic_branch/">Dynamic Lines</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-8" type="checkbox"/><label class="tocitem" for="menuitem-7-8"><span class="docs-label">DynamicGeneratorComponent</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_library/generated_AVR/">AVR</a></li><li><a class="tocitem" href="../../model_library/generated_Machine/">Machine</a></li><li><a class="tocitem" href="../../model_library/generated_PSS/">PSS</a></li><li><a class="tocitem" href="../../model_library/generated_Shaft/">Shaft</a></li><li><a class="tocitem" href="../../model_library/generated_TurbineGov/">TurbineGov</a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/public/">Public API Reference</a></li><li><a class="tocitem" href="../../api/internal/">Internal API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modeler Guide</a></li><li class="is-active"><a href>Time Series Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time Series Data</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NREL-SIIP/PowerSystems.jl/blob/master/docs/src/modeler_guide/time_series.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ts_data"><a class="docs-heading-anchor" href="#ts_data">Time Series Data</a><a id="ts_data-1"></a><a class="docs-heading-anchor-permalink" href="#ts_data" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>The bulk of the data in many power system models is time series data, in order to organize the data the potential inherent complexity, <code>PowerSystems.jl</code> has a set of definitions to enable consistent modeling.</p><ul><li><p><strong>Resolution</strong>: The period of time between each discrete value in the data, all resolutions are represented using <code>Dates.Period</code> types. For instance, a Day-ahead market data set usually has a resolution of <code>Hour(1)</code>, a Real-Time market data set usually has a resolution of <code>Minute(5)</code>.</p></li><li><p><strong>Static data</strong>: a single column of time series values for a component field (such as active power) where each time period is represented by a single value. This data commonly is obtained from historical information or the realization of a time-varying quantity.</p></li></ul><p>This category of Time Series data usually comes in the following format:</p><table><tr><th style="text-align: right">DateTime</th><th style="text-align: center">Value</th></tr><tr><td style="text-align: right">2020-09-01T00:00:00</td><td style="text-align: center">100.0</td></tr><tr><td style="text-align: right">2020-09-01T01:00:00</td><td style="text-align: center">101.0</td></tr><tr><td style="text-align: right">2020-09-01T02:00:00</td><td style="text-align: center">99.0</td></tr></table><p>Where a column (or several columns) represent the timestamp associated with the value and a column stores the values of interest.</p><ul><li><strong>Forecasts</strong>: Predicted values of a time-varying quantity that commonly features a look-ahead and can have multiple data values representing each time period. This data is used in simulation with receding horizons or data generated from forecasting algorithms.</li></ul><p>Forecast data usually comes in the following format:</p><table><tr><th style="text-align: right">DateTime</th><th style="text-align: center">0</th><th style="text-align: center">1</th><th style="text-align: center">2</th><th style="text-align: center">3</th><th style="text-align: center">4</th><th style="text-align: center">5</th><th style="text-align: center">6</th><th style="text-align: left">7</th></tr><tr><td style="text-align: right">2020-09-01T00:00:00</td><td style="text-align: center">100.0</td><td style="text-align: center">101.0</td><td style="text-align: center">101.3</td><td style="text-align: center">90.0</td><td style="text-align: center">98.0</td><td style="text-align: center">87.0</td><td style="text-align: center">88.0</td><td style="text-align: left">67.0</td></tr><tr><td style="text-align: right">2020-09-01T01:00:00</td><td style="text-align: center">101.0</td><td style="text-align: center">101.3</td><td style="text-align: center">99.0</td><td style="text-align: center">98.0</td><td style="text-align: center">88.9</td><td style="text-align: center">88.3</td><td style="text-align: center">67.1</td><td style="text-align: left">89.4</td></tr><tr><td style="text-align: right">2020-09-01T02:00:00</td><td style="text-align: center">99.0</td><td style="text-align: center">67.0</td><td style="text-align: center">89.0</td><td style="text-align: center">99.9</td><td style="text-align: center">100.0</td><td style="text-align: center">101.0</td><td style="text-align: center">112.0</td><td style="text-align: left">101.3</td></tr></table><p>Where a column (or several columns) represent the time stamp associated with the initial time of the forecast, and the columns represent the forecasted values.</p><ul><li><p><strong>Interval</strong>: The period of time between forecasts initial times. In <code>PowerSystems.jl</code> all intervals are represented using <code>Dates.Period</code> types. For instance, in a Day-Ahead market simulation, the interval of the time series is usually <code>Hour(24)</code>, in the example above, the interval is <code>Hour(1)</code>.</p></li><li><p><strong>Horizon</strong>: Is the count of discrete forecasted values, all horizons in <code>PowerSystems.jl</code> are represented with <code>Int</code>. For instance, many Day-ahead markets will have a forecast with a horizon 24.</p></li><li><p><strong>Forecast window</strong>: Represents the forecasted value starting at a particular initial time.</p></li></ul><p><strong>Currently <code>PowerSystems.jl</code> does not support Forecasts or SingleTimeSeries with dissimilar intervals or resolution.</strong></p><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><p><code>PowerSystems.jl</code> supports two categories of time series data depending on the process to obtain the data:</p><ul><li>Static data: a single column of time series values for a component field (such as active power) where each time period is represented by a single value. This data commonly is obtained from historical information or the realization of a time-varying quantity.</li><li>Forecasts: Predicted values of a time-varying quantity that commonly features a look-ahead and can have multiple data values representing each time period. This data is used in simulation with receding horizons or data generated from forecasting algorithms.</li></ul><h3 id="Static-Time-Series-Data"><a class="docs-heading-anchor" href="#Static-Time-Series-Data">Static Time Series Data</a><a id="Static-Time-Series-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Static-Time-Series-Data" title="Permalink"></a></h3><p>PowerSystems defines the Julia struct <a href="https://nrel-siip.github.io/InfrastructureSystems.jl/stable/InfrastructureSystems/#InfrastructureSystems.SingleTimeSeries"><code>SingleTimeSeries</code></a> to represent this data.</p><h3 id="Forecasts"><a class="docs-heading-anchor" href="#Forecasts">Forecasts</a><a id="Forecasts-1"></a><a class="docs-heading-anchor-permalink" href="#Forecasts" title="Permalink"></a></h3><p>PowerSystems defines the following Julia structs to represent forecasts:</p><ul><li><a href="https://nrel-siip.github.io/InfrastructureSystems.jl/stable/InfrastructureSystems/#InfrastructureSystems.Deterministic"><code>Deterministic</code></a>: Point forecast without any uncertainty representation.</li><li><a href="https://nrel-siip.github.io/InfrastructureSystems.jl/stable/InfrastructureSystems/#InfrastructureSystems.Probabilistic"><code>Probabilistic</code></a>: Stores a discretized cumulative distribution functions (CDFs) or probability distribution functions (PDFs) at each time step in the look-ahead window.</li><li><a href="https://nrel-siip.github.io/InfrastructureSystems.jl/stable/InfrastructureSystems/#InfrastructureSystems.Scenarios"><code>Scenarios</code></a>: Stores a set of probable trajectories for forecasted quantity with equal probability.</li></ul><h2 id="Storage"><a class="docs-heading-anchor" href="#Storage">Storage</a><a id="Storage-1"></a><a class="docs-heading-anchor-permalink" href="#Storage" title="Permalink"></a></h2><p>By default PowerSystems stores time series data in an HDF5 file. This prevents large datasets from overwhelming system memory. If you know that your dataset will fit in your computer&#39;s memory then you can increase performance by storing it in memory. Here is an example of how to do this:</p><pre><code class="language-julia hljs">sys = System(100.0; time_series_in_memory = true)</code></pre><p>PowerSystems stores the HDF5 file in the tmp filesystem by default. You can change this by passing <code>time_series_directory = X</code> when you create the System. This is required if the time series data is larger than the amount of tmp space available. You can also override the location by setting the environment variable SIIP<em>TIME</em>SERIES_DIRECTORY to another directory.</p><h3 id="Compression"><a class="docs-heading-anchor" href="#Compression">Compression</a><a id="Compression-1"></a><a class="docs-heading-anchor-permalink" href="#Compression" title="Permalink"></a></h3><p>PowerSystems does not enable HDF5 compression by default. You can enable it to get significant storage savings at the cost of CPU time.</p><pre><code class="language-julia hljs"># Take defaults.
sys = System(100.0; enable_compression = true)</code></pre><pre><code class="language-julia hljs"># Customize.
settings = CompressionSettings(
    enabled = true,
    type = CompressionTypes.DEFLATE,  # BLOSC is also supported
    level = 3,
    shuffle = true,
)
sys = System(100.0; compression = settings)</code></pre><p>Refer to the <a href="https://github.com/JuliaIO/HDF5.jl">HDF5.jl</a> and <a href="https://support.hdfgroup.org/HDF5/">HDF5</a> documentation for more details on the options.</p><h2 id="Creating-Time-Series-Data"><a class="docs-heading-anchor" href="#Creating-Time-Series-Data">Creating Time Series Data</a><a id="Creating-Time-Series-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-Time-Series-Data" title="Permalink"></a></h2><p>PowerSystems supports several methods to load time series data (Forecasts or StaticTimeSeries) into a System.</p><ul><li><p>Automated parsing during system construction, this method loads the data from CSV files. Refer to the parsing <a href="../generated_parsing/#parsing_time_series">documentation</a>.</p></li><li><p>Create directly from data in <code>TimeSeries.TimeArray</code> or <code>DataFrames.DataFrame</code>.</p></li></ul><p>Examples:</p><p>When creating data for <code>SingleTimeSeries</code> the user can directly pass a <code>TimeSeries.TimeArray</code> to the constructor.</p><pre><code class="language-julia hljs">    resolution = Dates.Hour(1)
    dates = range(DateTime(&quot;2020-01-01T00:00:00&quot;), step = resolution, length = 24)
    data = TimeArray(dates, ones(24))
    time_series = SingleTimeSeries(&quot;max_active_power&quot;, data)</code></pre><p>When creating time series data that represents forecasts, the data can be stored in any <code>AbstractDict</code> where the key is the initial time of the forecast and the value field is the forecast value. The value fields in the dictionary can be regular vectors or <code>TimeSeries.TimeArray</code>.</p><pre><code class="language-julia hljs">    resolution = Dates.Hour(1)
    data = Dict(
        DateTime(&quot;2020-01-01T00:00:00&quot;) =&gt; 10.0*ones(24),
        DateTime(&quot;2020-01-01T01:00:00&quot;) =&gt; 5.0*ones(24),
    )
    forecast = Deterministic(&quot;max_active_power&quot;, data, resolution)</code></pre><ul><li>Load from CSV file. For Deterministic forecasts, each row represents one look-ahead window. The first column must be the initial time and the rest must be the forecast values. The CSV file must have no header in the first row.</li></ul><pre><code class="language-julia hljs">    resolution = Dates.Hour(1)
    forecast = Deterministic(&quot;max_active_power&quot;, csv_filename, component, resolution)</code></pre><h2 id="Scaling-factors"><a class="docs-heading-anchor" href="#Scaling-factors">Scaling factors</a><a id="Scaling-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Scaling-factors" title="Permalink"></a></h2><p>Time series data can store actual component values (for instance MW) or scaling factors intended to be multiplied by a scalar to generate the component values. By default PowerSystems treats the values in the time series data as physical units. In order to specify them as scaling factors, you must pass the accessor function that provides the multiplier value. This value must be passed into the forecast when you create it.</p><p>Example:</p><pre><code class="language-julia hljs">    resolution = Dates.Hour(1)
    data = Dict(
        DateTime(&quot;2020-01-01T00:00:00&quot;) =&gt; ones(24),
        DateTime(&quot;2020-01-01T01:00:00&quot;) =&gt; ones(24),
    )
    forecast = Deterministic(
	&quot;max_active_power&quot;,
	data,
	resolution,
	scaling_factor_multiplier = get_max_active_power,
    )</code></pre><p>In this example, the forecasted component is a generator. Whenever the user retrieves the forecast data PowerSystems will call <code>get_max_active_power(component)</code> and multiply the result with the forecast values (scaling factors). For instance it the maximum active power returns the value 50.0 and the scaling factor at some time point is 0.65, the forecast value will correspond to 32.5.</p><h2 id="Adding-time-series-to-the-System"><a class="docs-heading-anchor" href="#Adding-time-series-to-the-System">Adding time series to the System</a><a id="Adding-time-series-to-the-System-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-time-series-to-the-System" title="Permalink"></a></h2><p>Adding time series data to a system requires a component that is already attached to the system. Extending the example above:</p><pre><code class="language-julia hljs">    add_time_series!(sys, component, forecast)</code></pre><p>In order to optimize the storage of time series data, time series can be shared across devices to avoid duplication. If the same forecast applies to multiple components then can call <code>add_time_series!</code>, passing the collection of components that share the time series data.</p><pre><code class="language-julia hljs">    add_time_series!(sys, components, forecast)</code></pre><p>This function stores a single copy of the data. Each component will store a reference to that data.</p><h2 id="Removing-time-series-data"><a class="docs-heading-anchor" href="#Removing-time-series-data">Removing time series data</a><a id="Removing-time-series-data-1"></a><a class="docs-heading-anchor-permalink" href="#Removing-time-series-data" title="Permalink"></a></h2><p>Time series instances can be removed from a system like this:</p><pre><code class="language-julia hljs">    remove_time_series!(Deterministic, sys, &quot;max_active_power&quot;)</code></pre><p><strong>Note</strong>: If you are storing time series data in an HDF5 file, this does not actually free up file space (HDF5 behavior). If you want to remove all or most time series instances then consider using <code>clear_time_series!</code>. It will delete the HDF5 file and create a new one. PowerSystems has plans to automate this type of workflow.</p><pre><code class="language-julia hljs">    clear_time_series!(sys)</code></pre><h2 id="Retrieving-time-series-data"><a class="docs-heading-anchor" href="#Retrieving-time-series-data">Retrieving time series data</a><a id="Retrieving-time-series-data-1"></a><a class="docs-heading-anchor-permalink" href="#Retrieving-time-series-data" title="Permalink"></a></h2><p>PowerSystems provides several methods to retrieve time series data. It is important that you choose the best one for your use case as there are performance implications. When an accessor function is used to create the forecast, the <code>get_time_series_array</code> methods will apply the associated multiplier and return a different value than is stored. If you want to explore the data as it&#39;s stored rather than as it&#39;s intended for modeling use, refer to the next section.</p><h3 id="Get-a-TimeArray-for-a-SingleTimeSeries"><a class="docs-heading-anchor" href="#Get-a-TimeArray-for-a-SingleTimeSeries">Get a TimeArray for a SingleTimeSeries</a><a id="Get-a-TimeArray-for-a-SingleTimeSeries-1"></a><a class="docs-heading-anchor-permalink" href="#Get-a-TimeArray-for-a-SingleTimeSeries" title="Permalink"></a></h3><pre><code class="language-julia hljs">    ta = get_time_series_array(
        SingleTimeSeries,
        component,
        &quot;max_active_power&quot;,
        start_time = DateTime(&quot;2020-01-01T00:00:00&quot;),
        len = 24,
    )</code></pre><p><strong>Note</strong>: The default behavior is to read all data, so specify <code>start_time</code> and <code>len</code> if you only need a subset of data.</p><h3 id="Get-a-TimeArray-for-a-Deterministic-forecast"><a class="docs-heading-anchor" href="#Get-a-TimeArray-for-a-Deterministic-forecast">Get a TimeArray for a Deterministic forecast</a><a id="Get-a-TimeArray-for-a-Deterministic-forecast-1"></a><a class="docs-heading-anchor-permalink" href="#Get-a-TimeArray-for-a-Deterministic-forecast" title="Permalink"></a></h3><p>For forecasts, the interfaces assume that modeling code will access one forecast window at a time. Here&#39;s how to get one window:</p><pre><code class="language-julia hljs">    ta = get_time_series_array(
        Deterministic,
        component,
        &quot;max_active_power&quot;,
        start_time = DateTime(&quot;2020-01-01T00:00:00&quot;),
    )</code></pre><h2 id="Data-exploration"><a class="docs-heading-anchor" href="#Data-exploration">Data exploration</a><a id="Data-exploration-1"></a><a class="docs-heading-anchor-permalink" href="#Data-exploration" title="Permalink"></a></h2><p>If you want to explore the time series data as it is stored in a system then you will want to use the <code>get_time_series</code> function.</p><p><strong>Warning</strong>: This will load all forecast windows into memory by default. Be aware of how much data is stored.</p><p><strong>Note</strong>: Unlike the functions above this will only return the exact stored data. It will not apply a scaling factor multiplier.</p><pre><code class="language-julia hljs">    forecast = get_time_series(Deterministic, component, &quot;max_active_power&quot;)</code></pre><p>You can limit the data returned by specifying <code>start_time</code> and <code>count</code>.</p><pre><code class="language-julia hljs">    forecast = get_time_series(
        Deterministic,
        component,
        &quot;max_active_power&quot;,
        start_time = DateTime(&quot;2020-01-09T00:00:00&quot;),
        count = 10,
    )</code></pre><p>Once you have a forecast instance you can access a specific window like this:</p><pre><code class="language-julia hljs">    window = get_window(forecast, DateTime(&quot;2020-01-09T00:00:00&quot;))</code></pre><p>or iterate over the look-ahead windows like this:</p><pre><code class="language-julia hljs">    for window in iterate_windows(forecast)
        @show window
    end</code></pre><h2 id="Using-forecast-data-in-simulations"><a class="docs-heading-anchor" href="#Using-forecast-data-in-simulations">Using forecast data in simulations</a><a id="Using-forecast-data-in-simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Using-forecast-data-in-simulations" title="Permalink"></a></h2><p>The interfaces documented up to this point are useful for the development of scripts and models that use a small amount of forecasting data or do not require accessing time series data multiple times. It is important to understand the performance implications of accessing forecast windows repeatedly like in the case of production cost modeling simulations.</p><p>If each forecast window contains an array of 24 floats and the windows cover an entire year then each retrieval will involve a small disk read. This can slow down a simulation significantly, especially if the underlying storage uses spinning disks.</p><p>PowerSystems provides an alternate interface that pre-fetches data into the system memory with large reads in order to mitigate this potential problem. The mechanism creates a cache of data and makes it available to the user.</p><p>It is highly recommended that you use this interface for modeling implementations. This is particularly relevant for models using large datasets.</p><pre><code class="language-julia hljs">    cache = ForecastCache(Deterministic, component, &quot;max_active_power&quot;)
    window1 = get_next_time_series_array(cache)
    window2 = get_next_time_series_array(cache)

    # or

    for window in cache
        @show window
    end</code></pre><p>Each iteration on the cache object will deliver the next forecast window. <code>get_next_time_series_array</code> will return <code>nothing</code> when all windows have been delivered.</p><h2 id="Transform-static-time-series-into-forecasts"><a class="docs-heading-anchor" href="#Transform-static-time-series-into-forecasts">Transform static time series into forecasts</a><a id="Transform-static-time-series-into-forecasts-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-static-time-series-into-forecasts" title="Permalink"></a></h2><p>A common workflow in developing models is transforming data generated from a realization and stored in a single column into deterministic forecasts to account for the effects of the look-ahead. Usually, this workflow leads to large data duplications in the overlapping windows between forecasts.</p><p>PowerSystems provides a method to transform <code>SingleTimeSeries</code> data into <code>Deterministic</code> forecasts without duplicating any data. The resulting object behaves exactly like a <code>Deterministic</code>. Instead of storing windows at each initial time it provides a view into the existing data at incrementing offsets.</p><p>Here&#39;s an example:</p><pre><code class="language-julia hljs">    # Create static time series data.
    resolution = Dates.Hour(1)
    dates = range(DateTime(&quot;2020-01-01T00:00:00&quot;), step = resolution, length = 8760)
    data = TimeArray(dates, ones(8760))
    ts = SingleTimeSeries(&quot;max_active_power&quot;, data)
    add_time_series!(sys, component, ts)

    # Transform it to Deterministic
    transform_single_time_series!(sys, 24, Hour(24))</code></pre><p>This function transforms all <code>SingleTimeSeries</code> instances stored in the system. You can also call it on a single component.</p><p>You can now access either a <code>Deterministic</code> or the original <code>SingleTimeSeries</code>.</p><pre><code class="language-julia hljs">    ta_forecast = get_time_series_array(
        Deterministic,
        component,
        &quot;max_active_power&quot;,
        start_time = DateTime(&quot;2020-01-01T00:00:00&quot;),
    )
    ta_static = get_time_series_array(SingleTimeSeries, component, &quot;max_active_power&quot;)</code></pre><p><strong>Note</strong>: The actual type of the returned forecast will be <code>DeterministicSingleTimeSeries</code>. This type and <code>Deterministic</code> are subtypes of <code>AbstractDeterministic</code> and implement all of the same methods (i.e., they behave identically).</p><h2 id="Time-Series-Validation"><a class="docs-heading-anchor" href="#Time-Series-Validation">Time Series Validation</a><a id="Time-Series-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Series-Validation" title="Permalink"></a></h2><p>PowerSystems applies validation rules whenever users add time series to a <code>System</code>. It will throw an exception if any rule is violated.</p><ol><li>All time series data, static or forecasts, must have the same resolution.</li><li>All forecasts must have identical parameters:  initial timestamp, horizon, interval, look-ahead window count.</li></ol><p>Static time series instances may have different start times and lengths.</p><h2 id="Data-Format"><a class="docs-heading-anchor" href="#Data-Format">Data Format</a><a id="Data-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Format" title="Permalink"></a></h2><p>Refer to this <a href="https://nrel-siip.github.io/InfrastructureSystems.jl/stable/dev_guide/time_series/#Data-Format">page</a> for details on how the time series data is stored in HDF5 files.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../system/">Â« System</a><a class="docs-footer-nextpage" href="../enumerated_types/">Enumerated Types Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Thursday 3 March 2022 01:00">Thursday 3 March 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
